{"ast":null,"code":"var _jsxFileName = \"/Users/justinzhao/Documents/GitHub/cloud_journal/src/components/Database/LastUpdated.js\";\nimport React from \"react\";\nimport Airtable from \"airtable\";\nimport { last } from \"lodash\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst API_KEY = process.env.REACT_APP_API_KEY;\nconst BASE_ID = \"app27OZGEFr5eKnk4\";\n\nclass LastUpdated extends React.Component {\n  constructor() {\n    super();\n    this.state = {\n      date: \"Loading...\"\n    };\n  }\n\n  async componentDidMount() {\n    var lastUpdatedDate = undefined;\n    var base = await new Airtable({\n      apiKey: API_KEY\n    }).base(BASE_ID);\n    base(\"Dailys\").select({\n      view: \"Grid view\",\n      sort: [{\n        field: \"date\",\n        direction: \"desc\"\n      }]\n    }).eachPage(function page(records, next) {\n      try {\n        lastUpdatedDate = records[0].fields.date;\n        this.setState({\n          date: lastUpdatedDate\n        });\n        next();\n      } catch {\n        return;\n      }\n    }, function (err) {\n      if (err) {\n        console.error(err);\n        return;\n      }\n    });\n\n    (async () => {\n      console.log(\"Getting lastUpdated date...\");\n\n      while (lastUpdatedDate == undefined) // define the condition as you like\n      await new Promise(resolve => setTimeout(resolve, 1000));\n\n      console.log(\"lastUpdated is \" + lastUpdatedDate);\n      this.setState({\n        date: lastUpdatedDate\n      });\n    })();\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"span\", {\n      children: this.state.date\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 12\n    }, this);\n  }\n\n}\n\nexport default LastUpdated;","map":{"version":3,"sources":["/Users/justinzhao/Documents/GitHub/cloud_journal/src/components/Database/LastUpdated.js"],"names":["React","Airtable","last","API_KEY","process","env","REACT_APP_API_KEY","BASE_ID","LastUpdated","Component","constructor","state","date","componentDidMount","lastUpdatedDate","undefined","base","apiKey","select","view","sort","field","direction","eachPage","page","records","next","fields","setState","err","console","error","log","Promise","resolve","setTimeout","render"],"mappings":";AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,QAAP,MAAqB,UAArB;AACA,SAASC,IAAT,QAAqB,QAArB;;AAEA,MAAMC,OAAO,GAAGC,OAAO,CAACC,GAAR,CAAYC,iBAA5B;AACA,MAAMC,OAAO,GAAG,mBAAhB;;AAEA,MAAMC,WAAN,SAA0BR,KAAK,CAACS,SAAhC,CAA0C;AACxCC,EAAAA,WAAW,GAAG;AACZ;AAEA,SAAKC,KAAL,GAAa;AACXC,MAAAA,IAAI,EAAE;AADK,KAAb;AAGD;;AAEsB,QAAjBC,iBAAiB,GAAG;AACxB,QAAIC,eAAe,GAAGC,SAAtB;AACA,QAAIC,IAAI,GAAG,MAAM,IAAIf,QAAJ,CAAa;AAAEgB,MAAAA,MAAM,EAAEd;AAAV,KAAb,EAAkCa,IAAlC,CAAuCT,OAAvC,CAAjB;AAEAS,IAAAA,IAAI,CAAC,QAAD,CAAJ,CACGE,MADH,CACU;AACNC,MAAAA,IAAI,EAAE,WADA;AAENC,MAAAA,IAAI,EAAE,CAAC;AAAEC,QAAAA,KAAK,EAAE,MAAT;AAAiBC,QAAAA,SAAS,EAAE;AAA5B,OAAD;AAFA,KADV,EAKGC,QALH,CAMI,SAASC,IAAT,CAAcC,OAAd,EAAuBC,IAAvB,EAA6B;AAC3B,UAAI;AACFZ,QAAAA,eAAe,GAAGW,OAAO,CAAC,CAAD,CAAP,CAAWE,MAAX,CAAkBf,IAApC;AACA,aAAKgB,QAAL,CAAc;AACZhB,UAAAA,IAAI,EAAEE;AADM,SAAd;AAGAY,QAAAA,IAAI;AACL,OAND,CAME,MAAM;AACN;AACD;AACF,KAhBL,EAiBI,UAAUG,GAAV,EAAe;AACb,UAAIA,GAAJ,EAAS;AACPC,QAAAA,OAAO,CAACC,KAAR,CAAcF,GAAd;AACA;AACD;AACF,KAtBL;;AAwBA,KAAC,YAAY;AACXC,MAAAA,OAAO,CAACE,GAAR,CAAY,6BAAZ;;AACA,aAAOlB,eAAe,IAAIC,SAA1B,EACE;AACA,YAAM,IAAIkB,OAAJ,CAAaC,OAAD,IAAaC,UAAU,CAACD,OAAD,EAAU,IAAV,CAAnC,CAAN;;AACFJ,MAAAA,OAAO,CAACE,GAAR,CAAY,oBAAoBlB,eAAhC;AACA,WAAKc,QAAL,CAAc;AACZhB,QAAAA,IAAI,EAAEE;AADM,OAAd;AAGD,KATD;AAUD;;AAEDsB,EAAAA,MAAM,GAAG;AACP,wBAAO;AAAA,gBAAO,KAAKzB,KAAL,CAAWC;AAAlB;AAAA;AAAA;AAAA;AAAA,YAAP;AACD;;AAnDuC;;AAsD1C,eAAeJ,WAAf","sourcesContent":["import React from \"react\";\nimport Airtable from \"airtable\";\nimport { last } from \"lodash\";\n\nconst API_KEY = process.env.REACT_APP_API_KEY;\nconst BASE_ID = \"app27OZGEFr5eKnk4\";\n\nclass LastUpdated extends React.Component {\n  constructor() {\n    super();\n\n    this.state = {\n      date: \"Loading...\",\n    };\n  }\n\n  async componentDidMount() {\n    var lastUpdatedDate = undefined;\n    var base = await new Airtable({ apiKey: API_KEY }).base(BASE_ID);\n\n    base(\"Dailys\")\n      .select({\n        view: \"Grid view\",\n        sort: [{ field: \"date\", direction: \"desc\" }],\n      })\n      .eachPage(\n        function page(records, next) {\n          try {\n            lastUpdatedDate = records[0].fields.date;\n            this.setState({\n              date: lastUpdatedDate,\n            });\n            next();\n          } catch {\n            return;\n          }\n        },\n        function (err) {\n          if (err) {\n            console.error(err);\n            return;\n          }\n        }\n      );\n    (async () => {\n      console.log(\"Getting lastUpdated date...\");\n      while (lastUpdatedDate == undefined)\n        // define the condition as you like\n        await new Promise((resolve) => setTimeout(resolve, 1000));\n      console.log(\"lastUpdated is \" + lastUpdatedDate);\n      this.setState({\n        date: lastUpdatedDate,\n      });\n    })();\n  }\n\n  render() {\n    return <span>{this.state.date}</span>;\n  }\n}\n\nexport default LastUpdated;\n"]},"metadata":{},"sourceType":"module"}